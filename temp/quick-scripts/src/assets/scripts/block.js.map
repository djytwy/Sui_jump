{"version":3,"sources":["assets/scripts/block.js"],"names":["cc","Class","Component","properties","start","icon","node","getChildByName","mid","up","down","left","right","is_jump_on_block","w_dst_pos","direction","mid_pos","convertToWorldSpaceAR","v2","dir","sub","min_len","mag","min_pos","jumpScore","up_pos","len","down_pos","left_pos","right_pos","x","y"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        this.icon = this.node.getChildByName(\"icon\");\r\n\r\n        this.mid = this.node.getChildByName(\"mid\");\r\n        this.up = this.node.getChildByName(\"up\");\r\n        this.down = this.node.getChildByName(\"down\");\r\n\r\n        this.left = this.node.getChildByName(\"left\");\r\n        this.right = this.node.getChildByName(\"right\");\r\n    },\r\n\r\n    // dir = 1, 右边跳跃, -1 表示左边跳跃\r\n    is_jump_on_block(w_dst_pos, direction) {\r\n        var mid_pos = this.mid.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        var dir = w_dst_pos.sub(mid_pos);\r\n        var min_len = dir.mag();\r\n        var min_pos = mid_pos;\r\n        //跳到中间得分多\r\n        var jumpScore = 2;\r\n\r\n        if (direction === 1) {\r\n            var up_pos = this.up.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            dir = w_dst_pos.sub(up_pos);\r\n            var len = dir.mag();\r\n            if (min_len > len) {\r\n                min_len = len;\r\n                min_pos = up_pos;\r\n                jumpScore = 1;\r\n            }\r\n\r\n            var down_pos = this.down.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            dir = w_dst_pos.sub(down_pos);\r\n            var len = dir.mag();\r\n            if (min_len > len) {\r\n                min_len = len;\r\n                min_pos = down_pos;\r\n                jumpScore = 1;\r\n            }\r\n        }\r\n        else {\r\n            var left_pos = this.left.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            dir = w_dst_pos.sub(left_pos);\r\n            var len = dir.mag();\r\n            if (min_len > len) {\r\n                min_len = len;\r\n                min_pos = left_pos;\r\n                jumpScore = 1;\r\n            }\r\n            var right_pos = this.right.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            dir = w_dst_pos.sub(right_pos);\r\n            var len = dir.mag();\r\n            if (min_len > len) {\r\n                min_len = len;\r\n                min_pos = right_pos;\r\n                jumpScore = 1;\r\n            }\r\n        }\r\n\r\n        // 找到了跳跃的位置距离参考点最近的那个参考点以及位置;\r\n        dir = w_dst_pos.sub(min_pos);\r\n        if (dir.mag() < 100) {\r\n            w_dst_pos.x = min_pos.x;\r\n            w_dst_pos.y = min_pos.y;\r\n            return jumpScore;\r\n        }\r\n        // end \r\n\r\n        return 0;\r\n    }\r\n\r\n    // update (dt) {},\r\n});\r\n"]}